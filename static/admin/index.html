<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Mondefetch Admin</title>
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <script src="https://unpkg.com/netlify-cms@^2.0.0/dist/netlify-cms.js"></script>
  </head>
  <body>
    <script>
      window.CMS_MANUAL_INIT = true;

      // Netlify Identity giriş sistemini başlat
      const siteUrl = 'https://mondefetch.netlify.app';

      if (['localhost', '127.0.0.1'].includes(window.location.hostname)) {
        localStorage.setItem('netlifySiteURL', siteUrl);
      }

      netlifyIdentity.init({
        APIUrl: `${siteUrl}/.netlify/identity`,
        logo: false
      });

      netlifyIdentity.on('init', user => {
        if (!user) {
          netlifyIdentity.open('login');
        }
      });

      netlifyIdentity.on('login', user => {
        CMS.init(); // Giriş sonrası CMS başlat
      });

      netlifyIdentity.on('logout', () => {
        location.reload();
      });
    </script>
  </body>
</html>
